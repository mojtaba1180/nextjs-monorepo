---
title: Context ها
description: مدیریت state سراسری با React Context
---

# Context ها

Context های این کتابخانه برای مدیریت state سراسری اپلیکیشن طراحی شده‌اند و قابلیت‌های پیشرفته‌ای برای مدیریت خطاها، مدال‌ها و اعلان‌ها ارائه می‌دهند.

## ErrorProvider

Context برای مدیریت خطاهای سراسری اپلیکیشن شامل خطاهای فیلد و خطاهای کلی.

### ویژگی‌ها

- **مدیریت خطاهای فیلد**: خطاهای مربوط به فیلدهای خاص
- **مدیریت خطاهای کلی**: خطاهای سراسری اپلیکیشن
- **Auto-dismiss**: قابلیت حذف خودکار خطاها
- **Type Safety**: پشتیبانی کامل از TypeScript

### راه‌اندازی

```tsx
import { ErrorProvider } from '@workspace/custom-ui'

function App() {
  return (
    <ErrorProvider>
      <YourApp />
    </ErrorProvider>
  )
}
```

### استفاده از خطاهای فیلد

```tsx
import { useFieldError } from '@workspace/custom-ui'

function MyForm() {
  const { errors, hasErrors, removeError, clearErrors } = useFieldError('email')

  const handleSubmit = async () => {
    try {
      await submitForm()
    } catch (error) {
      // اضافه کردن خطای فیلد
      addFieldError('email', {
        message: 'ایمیل نامعتبر است',
        type: 'validation',
        dismissible: true
      })
    }
  }

  return (
    <div>
      <input name="email" />
      {hasErrors && (
        <div>
          {errors.map(error => (
            <div key={error.id}>
              {error.message}
              {error.dismissible && (
                <button onClick={() => removeError(error.id)}>
                  ×
                </button>
              )}
            </div>
          ))}
        </div>
      )}
    </div>
  )
}
```

### استفاده از خطاهای کلی

```tsx
import { useAppError } from '@workspace/custom-ui'

function MyComponent() {
  const { errors, addError, removeError, clearErrors } = useAppError()

  const handleApiError = (error) => {
    addError({
      message: 'خطا در ارتباط با سرور',
      type: 'network',
      dismissible: true,
      severity: 'error'
    })
  }

  return (
    <div>
      {errors.map(error => (
        <div key={error.id} className={`alert alert-${error.severity}`}>
          {error.message}
          {error.dismissible && (
            <button onClick={() => removeError(error.id)}>
              بستن
            </button>
          )}
        </div>
      ))}
    </div>
  )
}
```

### استفاده کامل

```tsx
import { useError } from '@workspace/custom-ui'

function ErrorManager() {
  const {
    fieldErrors,
    appErrors,
    addFieldError,
    addAppError,
    clearAllFieldErrors,
    clearAppErrors,
    hasErrors
  } = useError()

  const handleValidationError = (field: string, message: string) => {
    addFieldError(field, {
      message,
      type: 'validation',
      dismissible: true
    })
  }

  const handleServerError = (message: string) => {
    addAppError({
      message,
      type: 'server',
      severity: 'error',
      dismissible: true
    })
  }

  return (
    <div>
      {hasErrors && (
        <div className="error-summary">
          <h3>خطاها:</h3>
          <button onClick={clearAllFieldErrors}>
            پاک کردن خطاهای فیلد
          </button>
          <button onClick={clearAppErrors}>
            پاک کردن خطاهای کلی
          </button>
        </div>
      )}
    </div>
  )
}
```

## ToastProvider

Context برای مدیریت اعلان‌های toast در اپلیکیشن.

### ویژگی‌ها

- **انواع مختلف**: success, error, warning, info
- **Auto-dismiss**: حذف خودکار پس از مدت زمان مشخص
- **Positioning**: موقعیت‌یابی قابل تنظیم
- **Animation**: انیمیشن‌های زیبا

### راه‌اندازی

```tsx
import { ToastProvider } from '@workspace/custom-ui'

function App() {
  return (
    <ToastProvider>
      <YourApp />
    </ToastProvider>
  )
}
```

### استفاده

```tsx
import { useToast } from '@workspace/custom-ui'

function MyComponent() {
  const { showToast } = useToast()

  const handleSuccess = () => {
    showToast({
      message: 'عملیات با موفقیت انجام شد',
      type: 'success',
      duration: 3000
    })
  }

  const handleError = () => {
    showToast({
      message: 'خطا در انجام عملیات',
      type: 'error',
      duration: 5000
    })
  }

  const handleWarning = () => {
    showToast({
      message: 'هشدار: این عملیات قابل بازگشت نیست',
      type: 'warning',
      duration: 4000
    })
  }

  return (
    <div>
      <button onClick={handleSuccess}>موفقیت</button>
      <button onClick={handleError}>خطا</button>
      <button onClick={handleWarning}>هشدار</button>
    </div>
  )
}
```

### مثال پیشرفته

```tsx
function AdvancedToastExample() {
  const { showToast, showToastWithAction } = useToast()

  const handleUndoAction = () => {
    showToastWithAction({
      message: 'آیتم حذف شد',
      type: 'success',
      action: {
        label: 'بازگردانی',
        onClick: () => {
          // منطق بازگردانی
          showToast({
            message: 'آیتم بازگردانده شد',
            type: 'info'
          })
        }
      }
    })
  }

  return (
    <button onClick={handleUndoAction}>
      حذف با قابلیت بازگردانی
    </button>
  )
}
```

## ModalProvider

Context برای مدیریت مدال‌های سراسری اپلیکیشن.

### ویژگی‌ها

- **مدیریت چندگانه**: پشتیبانی از چندین مدال همزمان
- **Stack Management**: مدیریت stack مدال‌ها
- **Animation**: انیمیشن‌های پیشرفته
- **Keyboard Navigation**: پشتیبانی از کلیدهای میانبر

### راه‌اندازی

```tsx
import { ModalProvider } from '@workspace/custom-ui'

function App() {
  return (
    <ModalProvider>
      <YourApp />
    </ModalProvider>
  )
}
```

### استفاده

```tsx
import { useModalContext } from '@workspace/custom-ui'

function MyComponent() {
  const { openModal, closeModal, isOpen, getModalData } = useModalContext()

  const handleOpenModal = () => {
    openModal('userModal', {
      userId: 123,
      title: 'ویرایش کاربر'
    })
  }

  return (
    <div>
      <button onClick={handleOpenModal}>
        باز کردن مدال
      </button>
      
      {isOpen('userModal') && (
        <div className="modal-overlay">
          <div className="modal">
            <h2>{getModalData('userModal')?.title}</h2>
            <p>شناسه: {getModalData('userModal')?.userId}</p>
            <button onClick={() => closeModal('userModal')}>
              بستن
            </button>
          </div>
        </div>
      )}
    </div>
  )
}
```

### مثال پیشرفته

```tsx
function AdvancedModalExample() {
  const { 
    openModal, 
    closeModal, 
    closeAllModals, 
    isOpen, 
    getModalData,
    getModalStack 
  } = useModalContext()

  const handleOpenNestedModal = () => {
    openModal('parentModal', { title: 'مدال والد' })
    
    setTimeout(() => {
      openModal('childModal', { title: 'مدال فرزند' })
    }, 1000)
  }

  const modalStack = getModalStack()

  return (
    <div>
      <button onClick={handleOpenNestedModal}>
        باز کردن مدال‌های تودرتو
      </button>
      
      <button onClick={closeAllModals}>
        بستن همه مدال‌ها ({modalStack.length})
      </button>
      
      {isOpen('parentModal') && (
        <div className="modal">
          <h2>{getModalData('parentModal')?.title}</h2>
          <button onClick={() => closeModal('parentModal')}>
            بستن والد
          </button>
        </div>
      )}
      
      {isOpen('childModal') && (
        <div className="modal">
          <h2>{getModalData('childModal')?.title}</h2>
          <button onClick={() => closeModal('childModal')}>
            بستن فرزند
          </button>
        </div>
      )}
    </div>
  )
}
```

## ترکیب Context ها

### مثال کامل

```tsx
import { 
  ErrorProvider, 
  ToastProvider, 
  ModalProvider 
} from '@workspace/custom-ui'

function App() {
  return (
    <ErrorProvider>
      <ToastProvider>
        <ModalProvider>
          <YourApp />
        </ModalProvider>
      </ToastProvider>
    </ErrorProvider>
  )
}

// استفاده در کامپوننت
function CompleteExample() {
  const { addAppError } = useError()
  const { showToast } = useToast()
  const { openModal } = useModalContext()

  const handleApiCall = async () => {
    try {
      const result = await apiCall()
      showToast({
        message: 'عملیات موفق',
        type: 'success'
      })
    } catch (error) {
      addAppError({
        message: 'خطا در API',
        type: 'network',
        severity: 'error'
      })
      
      showToast({
        message: 'خطا در انجام عملیات',
        type: 'error'
      })
      
      openModal('errorModal', {
        error: error.message,
        onRetry: handleApiCall
      })
    }
  }

  return (
    <button onClick={handleApiCall}>
      فراخوانی API
    </button>
  )
}
```
