---
title: کامپوننت‌های خطا
description: کامپوننت‌های نمایش و مدیریت خطاها
---

# کامپوننت‌های خطا

کامپوننت‌های خطا برای نمایش و مدیریت خطاها در اپلیکیشن طراحی شده‌اند.

## FieldErrorDisplay

کامپوننت نمایش خطاهای فیلد با قابلیت dismiss.

### ویژگی‌ها

- **Auto-dismiss**: حذف خودکار خطاها
- **Customizable**: قابل تنظیم ظاهر
- **Accessible**: سازگار با screen reader ها
- **Animation**: انیمیشن‌های زیبا

### استفاده پایه

```tsx
import { FieldErrorDisplay } from '@workspace/custom-ui'

function FieldErrorExample() {
  const [error, setError] = useState({
    id: '1',
    message: 'این فیلد الزامی است',
    type: 'validation',
    dismissible: true,
    timestamp: Date.now()
  })

  const handleDismiss = (errorId) => {
    setError(null)
  }

  return (
    <div>
      {error && (
        <FieldErrorDisplay
          error={error}
          onDismiss={handleDismiss}
          dismissible={error.dismissible}
        />
      )}
    </div>
  )
}
```

### استفاده در فرم

```tsx
import { FieldErrorDisplay, useFieldError } from '@workspace/custom-ui'

function FormWithErrors() {
  const { errors, removeError } = useFieldError('email')

  return (
    <div>
      <input name="email" placeholder="ایمیل" />
      
      {errors.map(error => (
        <FieldErrorDisplay
          key={error.id}
          error={error}
          onDismiss={(errorId) => removeError(errorId)}
          dismissible={error.dismissible}
          className="mt-1"
        />
      ))}
    </div>
  )
}
```

### سفارشی‌سازی ظاهر

```tsx
function CustomStyledError() {
  const error = {
    id: '1',
    message: 'خطای سفارشی',
    type: 'custom',
    dismissible: true,
    timestamp: Date.now()
  }

  return (
    <FieldErrorDisplay
      error={error}
      onDismiss={() => {}}
      className="bg-red-50 border-red-200 text-red-800"
      icon={<ExclamationTriangleIcon className="h-4 w-4" />}
    />
  )
}
```

## AppErrorDisplay

کامپوننت نمایش خطاهای کلی اپلیکیشن.

### ویژگی‌ها

- **Multiple Severities**: پشتیبانی از انواع مختلف خطا
- **Action Buttons**: دکمه‌های عملیات
- **Auto-refresh**: قابلیت refresh خودکار
- **Stack Trace**: نمایش stack trace برای خطاهای توسعه

### استفاده پایه

```tsx
import { AppErrorDisplay } from '@workspace/custom-ui'

function AppErrorExample() {
  const [error, setError] = useState({
    id: '1',
    message: 'خطا در ارتباط با سرور',
    type: 'network',
    severity: 'error',
    dismissible: true,
    timestamp: Date.now(),
    details: 'کد خطا: 500'
  })

  return (
    <div>
      {error && (
        <AppErrorDisplay
          error={error}
          onDismiss={() => setError(null)}
          onRetry={() => {
            // منطق retry
            console.log('تلاش مجدد...')
          }}
        />
      )}
    </div>
  )
}
```

### انواع مختلف خطا

```tsx
function DifferentErrorTypes() {
  const [errors, setErrors] = useState([
    {
      id: '1',
      message: 'خطای شبکه',
      type: 'network',
      severity: 'error',
      dismissible: true,
      timestamp: Date.now()
    },
    {
      id: '2',
      message: 'هشدار امنیتی',
      type: 'security',
      severity: 'warning',
      dismissible: true,
      timestamp: Date.now()
    },
    {
      id: '3',
      message: 'اطلاعات مهم',
      type: 'info',
      severity: 'info',
      dismissible: true,
      timestamp: Date.now()
    }
  ])

  const removeError = (errorId) => {
    setErrors(prev => prev.filter(error => error.id !== errorId))
  }

  return (
    <div className="space-y-2">
      {errors.map(error => (
        <AppErrorDisplay
          key={error.id}
          error={error}
          onDismiss={removeError}
          onRetry={() => console.log('Retry:', error.id)}
        />
      ))}
    </div>
  )
}
```

### خطا با عملیات

```tsx
function ErrorWithActions() {
  const [error, setError] = useState({
    id: '1',
    message: 'خطا در ذخیره فایل',
    type: 'file',
    severity: 'error',
    dismissible: true,
    timestamp: Date.now(),
    actions: [
      {
        label: 'تلاش مجدد',
        onClick: () => console.log('تلاش مجدد')
      },
      {
        label: 'ذخیره به عنوان',
        onClick: () => console.log('ذخیره به عنوان')
      }
    ]
  })

  return (
    <AppErrorDisplay
      error={error}
      onDismiss={() => setError(null)}
      onRetry={() => console.log('Retry')}
    />
  )
}
```

## ErrorToast

کامپوننت toast برای نمایش خطاها به صورت موقت.

### ویژگی‌ها

- **Auto-dismiss**: حذف خودکار پس از مدت زمان مشخص
- **Positioning**: موقعیت‌یابی قابل تنظیم
- **Animation**: انیمیشن‌های زیبا
- **Queue Management**: مدیریت صف toast ها

### استفاده پایه

```tsx
import { ErrorToast } from '@workspace/custom-ui'

function ToastExample() {
  const [toasts, setToasts] = useState([])

  const addToast = (message, type = 'error') => {
    const toast = {
      id: Date.now().toString(),
      message,
      type,
      duration: 5000,
      timestamp: Date.now()
    }
    setToasts(prev => [...prev, toast])
  }

  const removeToast = (toastId) => {
    setToasts(prev => prev.filter(toast => toast.id !== toastId))
  }

  return (
    <div>
      <button onClick={() => addToast('خطای نمونه')}>
        نمایش خطا
      </button>
      <button onClick={() => addToast('موفقیت', 'success')}>
        نمایش موفقیت
      </button>
      
      <div className="fixed top-4 right-4 space-y-2">
        {toasts.map(toast => (
          <ErrorToast
            key={toast.id}
            toast={toast}
            onDismiss={removeToast}
          />
        ))}
      </div>
    </div>
  )
}
```

### انواع مختلف Toast

```tsx
function DifferentToastTypes() {
  const [toasts, setToasts] = useState([])

  const addToast = (message, type, duration = 5000) => {
    const toast = {
      id: Date.now().toString(),
      message,
      type,
      duration,
      timestamp: Date.now()
    }
    setToasts(prev => [...prev, toast])
  }

  return (
    <div className="space-x-2">
      <button 
        onClick={() => addToast('خطا در عملیات', 'error')}
        className="btn-danger"
      >
        خطا
      </button>
      
      <button 
        onClick={() => addToast('عملیات موفق', 'success')}
        className="btn-success"
      >
        موفقیت
      </button>
      
      <button 
        onClick={() => addToast('هشدار مهم', 'warning')}
        className="btn-warning"
      >
        هشدار
      </button>
      
      <button 
        onClick={() => addToast('اطلاعات مفید', 'info')}
        className="btn-info"
      >
        اطلاعات
      </button>
      
      <div className="fixed top-4 right-4 space-y-2 z-50">
        {toasts.map(toast => (
          <ErrorToast
            key={toast.id}
            toast={toast}
            onDismiss={(id) => setToasts(prev => prev.filter(t => t.id !== id))}
          />
        ))}
      </div>
    </div>
  )
}
```

### Toast با عملیات

```tsx
function ToastWithActions() {
  const [toasts, setToasts] = useState([])

  const addActionToast = () => {
    const toast = {
      id: Date.now().toString(),
      message: 'فایل حذف شد',
      type: 'success',
      duration: 0, // بدون auto-dismiss
      timestamp: Date.now(),
      action: {
        label: 'بازگردانی',
        onClick: () => {
          console.log('بازگردانی فایل')
          setToasts(prev => prev.filter(t => t.id !== toast.id))
        }
      }
    }
    setToasts(prev => [...prev, toast])
  }

  return (
    <div>
      <button onClick={addActionToast}>
        حذف با قابلیت بازگردانی
      </button>
      
      <div className="fixed top-4 right-4 space-y-2 z-50">
        {toasts.map(toast => (
          <ErrorToast
            key={toast.id}
            toast={toast}
            onDismiss={(id) => setToasts(prev => prev.filter(t => t.id !== id))}
          />
        ))}
      </div>
    </div>
  )
}
```

## ToastContainer

کانتینر برای مدیریت و نمایش toast ها.

### ویژگی‌ها

- **Position Management**: مدیریت موقعیت toast ها
- **Z-Index Management**: مدیریت لایه‌ها
- **Animation Coordination**: هماهنگی انیمیشن‌ها
- **Queue Management**: مدیریت صف toast ها

### استفاده

```tsx
import { ToastContainer, useToast } from '@workspace/custom-ui'

function App() {
  return (
    <ToastProvider>
      <YourApp />
      <ToastContainer position="top-right" />
    </ToastProvider>
  )
}

function ToastExample() {
  const { showToast } = useToast()

  const handleShowToast = (type) => {
    showToast({
      message: `Toast ${type}`,
      type,
      duration: 3000
    })
  }

  return (
    <div className="space-x-2">
      <button onClick={() => handleShowToast('error')}>
        خطا
      </button>
      <button onClick={() => handleShowToast('success')}>
        موفقیت
      </button>
      <button onClick={() => handleShowToast('warning')}>
        هشدار
      </button>
      <button onClick={() => handleShowToast('info')}>
        اطلاعات
      </button>
    </div>
  )
}
```

### موقعیت‌های مختلف

```tsx
function DifferentPositions() {
  const [position, setPosition] = useState('top-right')

  return (
    <ToastProvider>
      <div>
        <select value={position} onChange={(e) => setPosition(e.target.value)}>
          <option value="top-left">بالا چپ</option>
          <option value="top-right">بالا راست</option>
          <option value="bottom-left">پایین چپ</option>
          <option value="bottom-right">پایین راست</option>
          <option value="top-center">بالا وسط</option>
          <option value="bottom-center">پایین وسط</option>
        </select>
        
        <ToastContainer position={position} />
      </div>
    </ToastProvider>
  )
}
```

## مثال‌های کاربردی

### مدیریت خطا در API

```tsx
function ApiErrorHandling() {
  const { addAppError } = useError()
  const { showToast } = useToast()

  const handleApiCall = async () => {
    try {
      const response = await fetch('/api/data')
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`)
      }
      
      const data = await response.json()
      showToast({
        message: 'داده‌ها با موفقیت دریافت شد',
        type: 'success'
      })
      
    } catch (error) {
      // نمایش خطا در toast
      showToast({
        message: 'خطا در دریافت داده‌ها',
        type: 'error',
        duration: 5000
      })
      
      // اضافه کردن خطا به error context
      addAppError({
        message: error.message,
        type: 'api',
        severity: 'error',
        dismissible: true,
        details: error.stack
      })
    }
  }

  return (
    <button onClick={handleApiCall}>
      دریافت داده‌ها
    </button>
  )
}
```

### مدیریت خطا در فرم

```tsx
function FormErrorHandling() {
  const { addFieldError, clearFieldErrors } = useError()
  const { showToast } = useToast()

  const handleSubmit = async (data) => {
    try {
      // پاک کردن خطاهای قبلی
      clearFieldErrors('email')
      clearFieldErrors('password')
      
      const response = await submitForm(data)
      
      showToast({
        message: 'فرم با موفقیت ارسال شد',
        type: 'success'
      })
      
    } catch (error) {
      if (error.field) {
        // خطای فیلد خاص
        addFieldError(error.field, {
          message: error.message,
          type: 'validation',
          dismissible: true
        })
      } else {
        // خطای کلی
        showToast({
          message: 'خطا در ارسال فرم',
          type: 'error'
        })
      }
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      {/* فیلدهای فرم */}
    </form>
  )
}
```
